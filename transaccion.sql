SELECT mejor_amigo.anadidor, mejor_amigo.anadido FROM mejor_amigo WHERE exists(SELECT * FROM mejor_amigo as ma2 WHERE ma2.anadidor=mejor_amigo.anadido and ma2.anadido=mejor_amigo.anadidor) and exists(SELECT * FROM comentar cross join publicacion WHERE comentar.id_publicacion=publicacion.id_publicacion and comentar.nickname=mejor_amigo.anadido and publicacion.nickname=mejor_amigo.anadidor); --Seleccionamos las parejas (u1, u2) para las que u2 tiene como mejor amigo a u1, y además existe un comentario de u2 en alguna publicación de u1